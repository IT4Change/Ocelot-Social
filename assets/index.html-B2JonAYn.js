import{_ as u}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as d,o as m,c as h,a as n,b as e,d as i,w as a,e as c}from"./app-DAOD0aSW.js";const p="/assets/graphql-playground-Ci-zpEKq.png",b={},v=c(`<h1 id="backend" tabindex="-1"><a class="header-anchor" href="#backend"><span>Backend</span></a></h1><h2 id="installation-with-docker" tabindex="-1"><a class="header-anchor" href="#installation-with-docker"><span>Installation with Docker</span></a></h2><p>Run the following command to install everything through docker.</p><p>The installation takes a bit longer on the first pass or on rebuild ...</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># in main folder</span>
$ <span class="token function">docker-compose</span> up
<span class="token comment"># or</span>
<span class="token comment"># rebuild the containers for a cleanup</span>
$ <span class="token function">docker-compose</span> up <span class="token parameter variable">--build</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),k={href:"http://localhost:4000/",target:"_blank",rel:"noopener noreferrer"},g=n("h2",{id:"installation-without-docker",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#installation-without-docker"},[n("span",null,"Installation without Docker")])],-1),_={href:"https://nodejs.org/en/",target:"_blank",rel:"noopener noreferrer"},f=n("code",null,"v16.19.0",-1),y=n("code",null,"v20.12.1",-1),x={href:"https://github.com/Ocelot-Social-Community/Ocelot-Social/issues/4082",target:"_blank",rel:"noopener noreferrer"},w={href:"https://github.com/nvm-sh/nvm",target:"_blank",rel:"noopener noreferrer"},$=n("code",null,"nvm",-1),D=c(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># install Node</span>
$ <span class="token builtin class-name">cd</span> backend
$ nvm <span class="token function">install</span> v20.12.1
$ nvm use v20.12.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),A={href:"https://yarnpkg.com/en/",target:"_blank",rel:"noopener noreferrer"},T=c(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># in main folder</span>
$ <span class="token builtin class-name">cd</span> backend
$ <span class="token function">yarn</span> <span class="token function">install</span>
<span class="token comment"># or just</span>
$ <span class="token function">yarn</span>
<span class="token comment"># or just later on to use version of &quot;.nvmrc&quot; file</span>
$ nvm use <span class="token operator">&amp;&amp;</span> <span class="token function">yarn</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Copy Environment Variables:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># in backend/</span>
$ <span class="token function">cp</span> .env.template .env
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,3),I={href:"http://localhost:7474",target:"_blank",rel:"noopener noreferrer"},W=c(`<p>Start the backend for development with:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># in backend/</span>
$ <span class="token function">yarn</span> run dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>or start the backend in production environment with:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># in backend/</span>
$ <span class="token function">yarn</span> run start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>For e-mail delivery, please configure at least <code>SMTP_HOST</code> and <code>SMTP_PORT</code> in your <code>.env</code> configuration file.</p>`,5),N={href:"http://localhost:4000/",target:"_blank",rel:"noopener noreferrer"},L=n("p",null,[n("img",{src:p,alt:"GraphQL Playground",loading:"lazy"})],-1),R=n("h3",{id:"database-indexes-and-constraints",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#database-indexes-and-constraints"},[n("span",null,"Database Indexes and Constraints")])],-1),S=n("p",null,"Database indexes and constraints need to be created and upgraded when the database and the backend are running:",-1),E=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in main folder while docker-compose is running"),e(`
$ `),n("span",{class:"token function"},"docker"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` run db:migrate init

`),n("span",{class:"token comment"},"# only once: init admin user and create indexes and constraints in Neo4j database"),e(`
`),n("span",{class:"token comment"},"# for development"),e(`
$ `),n("span",{class:"token function"},"docker"),e(" compose "),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` prod:migrate init
`),n("span",{class:"token comment"},"# in production mode use command"),e(`
$ `),n("span",{class:"token function"},"docker"),e(" compose "),n("span",{class:"token builtin class-name"},"exec"),e(" backend /bin/sh "),n("span",{class:"token parameter variable"},"-c"),e(),n("span",{class:"token string"},'"yarn prod:migrate init"'),e(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),C=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in main folder with docker compose running"),e(`
$ `),n("span",{class:"token function"},"docker"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` run db:migrate up
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),G=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in folder backend/ while database is running"),e(`
`),n("span",{class:"token comment"},"# make sure your database is running on http://localhost:7474/browser/"),e(`
`),n("span",{class:"token function"},"yarn"),e(` run db:migrate init
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),P=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in backend/ with database running (In docker or local)"),e(`
`),n("span",{class:"token function"},"yarn"),e(` run db:migrate up
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),j=n("h4",{id:"seed-database",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#seed-database"},[n("span",null,"Seed Database")])],-1),q=n("p",null,"If you want your backend to return anything else than an empty response, you need to seed your database:",-1),B=n("p",null,"In another terminal run:",-1),O=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in main folder while docker-compose is running"),e(`
$ `),n("span",{class:"token function"},"docker"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` run db:seed
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Q=n("p",null,"To reset the database run:",-1),M=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in main folder while docker-compose is running"),e(`
$ `),n("span",{class:"token function"},"docker"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` run db:reset
`),n("span",{class:"token comment"},"# you could also wipe out your neo4j database and delete all volumes with:"),e(`
$ `),n("span",{class:"token function"},"docker-compose"),e(" down "),n("span",{class:"token parameter variable"},"-v"),e(`
`),n("span",{class:"token comment"},"# if container is not running, run this command to set up your database indexes and constraints"),e(`
$ `),n("span",{class:"token function"},"docker"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` run db:migrate init
`),n("span",{class:"token comment"},"# And then upgrade the indexes and const"),e(`
$ `),n("span",{class:"token function"},"docker"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` run db:migrate up
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),V=n("p",null,"Run:",-1),z=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in backend/ while database is running"),e(`
$ `),n("span",{class:"token function"},"yarn"),e(` run db:seed
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),J=n("p",null,"To reset the database run:",-1),F=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in backend/ while database is running"),e(`
$ `),n("span",{class:"token function"},"yarn"),e(` run db:reset
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),H=n("h3",{id:"data-migrations",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#data-migrations"},[n("span",null,"Data migrations")])],-1),Y=n("p",null,"Although Neo4J is schema-less,you might find yourself in a situation in which you have to migrate your data e.g. because your data modeling has changed.",-1),K=n("p",null,"Generate a data migration file:",-1),U=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in main folder while docker-compose is running"),e(`
$ `),n("span",{class:"token function"},"docker-compose"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` run db:migrate:create your_data_migration
`),n("span",{class:"token comment"},"# Edit the file in ./src/db/migrations/"),e(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),X=n("p",null,"To run the migration:",-1),Z=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in main folder while docker-compose is running"),e(`
$ `),n("span",{class:"token function"},"docker"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(` run db:migrate up
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),nn=n("p",null,"Generate a data migration file:",-1),en=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in backend/"),e(`
$ `),n("span",{class:"token function"},"yarn"),e(` run db:migrate:create your_data_migration
`),n("span",{class:"token comment"},"# Edit the file in ./src/db/migrations/"),e(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),an=n("p",null,"To run the migration:",-1),sn=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in backend/ while database is running"),e(`
$ `),n("span",{class:"token function"},"yarn"),e(` run db:migrate up
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),tn=n("h2",{id:"testing",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#testing"},[n("span",null,"Testing")])],-1),ln=n("p",null,[n("strong",null,"Beware"),e(": We have no multiple database setup at the moment. We clean the database after each test, running the tests will wipe out all your data!")],-1),on=n("p",null,"Run the unit tests:",-1),cn=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in main folder while docker-compose is running"),e(`
$ `),n("span",{class:"token function"},"docker"),e(),n("span",{class:"token builtin class-name"},"exec"),e(" backend "),n("span",{class:"token function"},"yarn"),e(" run "),n("span",{class:"token builtin class-name"},"test"),e(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),dn=n("p",null,"Run the unit tests:",-1),rn=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# in backend/ while database is running"),e(`
$ `),n("span",{class:"token function"},"yarn"),e(" run "),n("span",{class:"token builtin class-name"},"test"),e(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1);function un(mn,hn){const l=d("ExternalLinkIcon"),r=d("RouteLink"),o=d("Tabs");return m(),h("div",null,[v,n("p",null,[e("Wait a little until your backend is up and running at "),n("a",k,[e("http://localhost:4000/"),i(l)]),e(".")]),g,n("p",null,[e("For the local installation you need a recent version of "),n("a",_,[e("Node"),i(l)]),e(" (>= "),f,e("). We are using "),y,e(" and therefore we recommend to use the same version ("),n("a",x,[e("see"),i(l)]),e(" some known problems with more recent node versions). You can use the "),n("a",w,[e("node version manager"),i(l)]),e(),$,e(" to switch between different local Node versions:")]),D,n("p",null,[e("Install node dependencies with "),n("a",A,[e("yarn"),i(l)]),e(":")]),T,n("p",null,[e("Configure the new file according to your needs and your local setup. Make sure a "),n("a",I,[e("local Neo4J"),i(l)]),e(" instance is up and running.")]),W,n("p",null,[e("Your backend is up and running at "),n("a",N,[e("http://localhost:4000/"),i(l)]),e(" This will start the GraphQL service (by default on localhost:4000) where you can issue GraphQL requests or access GraphQL Playground in the browser. More details about our GraphQL playground and how to use it with ocelot.social can be found "),i(r,{to:"/backend/src/graphql/GraphQL-Playground.html"},{default:a(()=>[e("here")]),_:1}),e(".")]),L,R,S,i(o,{id:"57",data:[{id:"Docker"},{id:"Without Docker"}],active:0},{title0:a(({value:s,isActive:t})=>[e("Docker")]),title1:a(({value:s,isActive:t})=>[e("Without Docker")]),tab0:a(({value:s,isActive:t})=>[E,C]),tab1:a(({value:s,isActive:t})=>[G,P]),_:1}),j,q,i(o,{id:"73",data:[{id:"Docker"},{id:"Without Docker"}],active:0},{title0:a(({value:s,isActive:t})=>[e("Docker")]),title1:a(({value:s,isActive:t})=>[e("Without Docker")]),tab0:a(({value:s,isActive:t})=>[B,O,Q,M]),tab1:a(({value:s,isActive:t})=>[V,z,J,F]),_:1}),H,Y,i(o,{id:"101",data:[{id:"Docker"},{id:"Without Docker"}],active:0},{title0:a(({value:s,isActive:t})=>[e("Docker")]),title1:a(({value:s,isActive:t})=>[e("Without Docker")]),tab0:a(({value:s,isActive:t})=>[K,U,X,Z]),tab1:a(({value:s,isActive:t})=>[nn,en,an,sn]),_:1}),tn,ln,i(o,{id:"129",data:[{id:"Docker"},{id:"Without Docker"}],active:0},{title0:a(({value:s,isActive:t})=>[e("Docker")]),title1:a(({value:s,isActive:t})=>[e("Without Docker")]),tab0:a(({value:s,isActive:t})=>[on,cn]),tab1:a(({value:s,isActive:t})=>[dn,rn]),_:1})])}const vn=u(b,[["render",un],["__file","index.html.vue"]]),kn=JSON.parse('{"path":"/backend/","title":"Backend","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Installation with Docker","slug":"installation-with-docker","link":"#installation-with-docker","children":[]},{"level":2,"title":"Installation without Docker","slug":"installation-without-docker","link":"#installation-without-docker","children":[{"level":3,"title":"Database Indexes and Constraints","slug":"database-indexes-and-constraints","link":"#database-indexes-and-constraints","children":[]},{"level":3,"title":"Data migrations","slug":"data-migrations","link":"#data-migrations","children":[]}]},{"level":2,"title":"Testing","slug":"testing","link":"#testing","children":[]}],"git":{"createdTime":1729782505000,"updatedTime":1729782505000,"contributors":[{"name":"Wolfgang Huß","email":"wolle.huss@pjannto.com","commits":1}]},"readingTime":{"minutes":2.62,"words":786},"filePathRelative":"backend/README.md","localizedDate":"October 24, 2024","excerpt":"\\n<h2>Installation with Docker</h2>\\n<p>Run the following command to install everything through docker.</p>\\n<p>The installation takes a bit longer on the first pass or on rebuild ...</p>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"token comment\\"># in main folder</span>\\n$ <span class=\\"token function\\">docker-compose</span> up\\n<span class=\\"token comment\\"># or</span>\\n<span class=\\"token comment\\"># rebuild the containers for a cleanup</span>\\n$ <span class=\\"token function\\">docker-compose</span> up <span class=\\"token parameter variable\\">--build</span>\\n</code></pre></div>"}');export{vn as comp,kn as data};
