import{u as $,f as Z,g as ee,h as j,i as te,j as ae,t as le,k as se,l as A,m as q,n as re,p as G,q as a,s as U,v as F,R as M,x as ue,y as ne,z as oe,A as ie,B as ce,C as pe,D as ve,E as he,O as me,F as de,G as ye,P as ge,H as be,I as ke,J as _}from"./app-DAOD0aSW.js";const fe=["/CHANGELOG.html","/CODE_OF_CONDUCT.html","/CONTRIBUTING.html","/LICENSE.html","/","/SUMMARY.html","/documentation.html","/testing.html","/backend/","/backend/graphql.html","/backend/neo4j-graphql-js.html","/backend/testing.html","/cypress/","/cypress/features.html","/deployment/DOCKER_MORE_CLOSELY.html","/deployment/Minikube.html","/deployment/","/deployment/TODO-next-update.html","/deployment/deployment-values.html","/deployment/deployment.html","/frontend/","/neo4j/","/webapp/","/webapp/components.html","/webapp/html.html","/webapp/scss.html","/webapp/testing.html","/webapp/vue.html","/webapp/maintenance/","/backend/src/graphql/GraphQL-Playground.html","/deployment/src/kubernetes/Backup.html","/deployment/src/kubernetes/DigitalOcean.html","/deployment/src/kubernetes/","/webapp/components/Category/","/webapp/components/DateTime/","/webapp/components/Logo/demo.html","/webapp/static/img/mapbox/marker-icons/","/404.html","/backend/src/graphql/","/backend/src/","/deployment/src/","/webapp/components/","/webapp/components/Logo/","/webapp/static/img/mapbox/","/webapp/static/img/","/webapp/static/"],we="SEARCH_PRO_QUERY_HISTORY",m=$(we,[]),Re=()=>{const{queryHistoryCount:l}=_,s=l>0;return{enabled:s,queryHistory:m,addQueryHistory:r=>{s&&(m.value.length<l?m.value=Array.from(new Set([r,...m.value])):m.value=Array.from(new Set([r,...m.value.slice(0,l-1)])))},removeQueryHistory:r=>{m.value=[...m.value.slice(0,r),...m.value.slice(r+1)]}}},T=l=>fe[l.id]+("anchor"in l?`#${l.anchor}`:""),He="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:E}=_,d=$(He,[]),Ce=()=>{const l=E>0;return{enabled:l,resultHistory:d,addResultHistory:s=>{if(l){const r={link:T(s),display:s.display};"header"in s&&(r.header=s.header),d.value.length<E?d.value=[r,...d.value]:d.value=[r,...d.value.slice(0,E-1)]}},removeResultHistory:s=>{d.value=[...d.value.slice(0,s),...d.value.slice(s+1)]}}},xe=l=>{const s=ce(),r=j(),Q=pe(),n=A(!1),g=ve([]);return he(()=>{const{search:w,terminate:y}=me(),R=()=>{g.value=[],n.value=!1},b=ke(v=>{n.value=!0,v?w(v,r.value,s.value).then(h=>{var H,k;return((k=(H=s.value).searchFilter)==null?void 0:k.call(H,h,v,r.value,Q.value))??h}).then(h=>{g.value=h,n.value=!1}).catch(h=>{console.error(h),R()}):R()},_.searchDelay);G([l,r],()=>b(l.value),{immediate:!0}),de(()=>{y()})}),{searching:n,results:g}};var Se=Z({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:s}){const r=ee(),Q=j(),n=te(ae),{enabled:g,addQueryHistory:w,queryHistory:y,removeQueryHistory:R}=Re(),{enabled:b,resultHistory:v,addResultHistory:h,removeResultHistory:H}=Ce(),k=g||b,S=le(l,"query"),{results:f,searching:N}=xe(S),u=se({isQuery:!0,index:0}),c=A(0),p=A(0),I=q(()=>k&&(y.value.length>0||v.value.length>0)),O=q(()=>f.value.length>0),D=q(()=>f.value[c.value]||null),B=()=>{const{isQuery:e,index:t}=u;t===0?(u.isQuery=!e,u.index=e?v.value.length-1:y.value.length-1):u.index=t-1},Y=()=>{const{isQuery:e,index:t}=u;t===(e?y.value.length-1:v.value.length-1)?(u.isQuery=!e,u.index=0):u.index=t+1},z=()=>{c.value=c.value>0?c.value-1:f.value.length-1,p.value=D.value.contents.length-1},J=()=>{c.value=c.value<f.value.length-1?c.value+1:0,p.value=0},K=()=>{p.value<D.value.contents.length-1?p.value+=1:J()},V=()=>{p.value>0?p.value-=1:z()},L=e=>e.map(t=>ye(t)?t:a(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=ge[e.index]||"$content",[o,x=""]=be(t)?t[Q.value].split("$content"):t.split("$content");return e.display.map(i=>a("div",L([o,...i,x])))}return e.display.map(t=>a("div",L(t)))},C=()=>{c.value=0,p.value=0,s("updateQuery",""),s("close")};return re("keydown",e=>{if(l.isFocusing){if(O.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=D.value.contents[p.value];w(l.query),h(t),r.push(T(t)),C()}}else if(b){if(e.key==="ArrowUp")B();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:t}=u;u.isQuery?(s("updateQuery",y.value[t]),e.preventDefault()):(r.push(v.value[t].link),C())}}}}),G([c,p],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>a("div",{class:["search-pro-result-wrapper",{empty:S.value?!O.value:!I.value}],id:"search-pro-results"},S.value===""?k?I.value?[g?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},n.value.queryHistory),y.value.map((e,t)=>a("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===t}],onClick:()=>{s("updateQuery",e)}},[a(U,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},e),a("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:o=>{o.preventDefault(),o.stopPropagation(),R(t)}})]))])):null,b?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},n.value.resultHistory),v.value.map((e,t)=>a(M,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===t}],onClick:()=>{C()}},()=>[a(U,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[e.header?a("div",{class:"content-header"},e.header):null,a("div",e.display.map(o=>L(o)).flat())]),a("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:o=>{o.preventDefault(),o.stopPropagation(),H(t)}})]))])):null]:n.value.emptyHistory:n.value.emptyResult:N.value?a(ue,{hint:n.value.searching}):O.value?a("ul",{class:"search-pro-result-list"},f.value.map(({title:e,contents:t},o)=>{const x=c.value===o;return a("li",{class:["search-pro-result-list-item",{active:x}]},[a("div",{class:"search-pro-result-title"},e||n.value.defaultTitle),t.map((i,X)=>{const P=x&&p.value===X;return a(M,{to:T(i),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{w(l.query),h(i),C()}},()=>[i.type==="text"?null:a(i.type==="title"?ne:i.type==="heading"?oe:ie,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[i.type==="text"&&i.header?a("div",{class:"content-header"},i.header):null,a("div",W(i))])])})])})):n.value.emptyResult)}});export{Se as default};
